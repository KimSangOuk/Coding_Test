< LV 1 >
[자동차 대여 기록에서 장기/단기 대여 구분하기]
SELECT HISTORY_ID, CAR_ID, DATE_FORMAT(START_DATE,'%Y-%m-%d') AS START_DATE, DATE_FORMAT(END_DATE,'%Y-%m-%d') AS END_DATE, IF(END_DATE-START_DATE>=30, '장기 대여','단기 대여') AS RENT_TYPE FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE YEAR(START_DATE)=2022 AND MONTH(START_DATE)=9 ORDER BY HISTORY_ID DESC
- 오답 - IF의 사용방법과 DATEDIFF의 사용방법 지식을 처음 알았다.
[특정 옵션이 포함된 자동차 리스트 구하기]
SELECT * FROM CAR_RENTAL_COMPANY_CAR WHERE LOCATE('네비게이션',OPTIONS)!=0 ORDER BY CAR_ID DESC

< LV 2 >
[조건에 부합하는 중고거래 상태 조회하기]
SELECT BOARD_ID, WRITER_ID, TITLE, PRICE, CASE WHEN STATUS='SALE' THEN '판매중' WHEN STATUS='RESERVED' THEN '예약중' ELSE '거래완료' END AS STATUS FROM USED_GOODS_BOARD WHERE DATE_FORMAT(CREATED_DATE,'%Y-%m-%d')='2022-10-05' ORDER BY BOARD_ID DESC
[자동차 평균 대여 기간 구하기]
SELECT CAR_ID, ROUND(AVG(DATEDIFF(END_DATE,START_DATE)+1),1) AS AVERAGE_DURATION FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY GROUP BY CAR_ID HAVING AVERAGE_DURATION>=7 ORDER BY AVERAGE_DURATION DESC, CAR_ID DESC