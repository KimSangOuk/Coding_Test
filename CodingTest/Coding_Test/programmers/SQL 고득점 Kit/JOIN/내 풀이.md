< LV 2 >
[조건에 맞는 도서와 저자 리스트 출력하기]
SELECT BOOK_ID, AUTHOR_NAME, DATE_FORMAT(PUBLISHED_DATE,"%Y-%m-%d") AS PUBLISHED_DATE FROM BOOK JOIN AUTHOR ON BOOK.AUTHOR_ID=AUTHOR.AUTHOR_ID WHERE CATEGORY IN('경제') ORDER BY PUBLISHED_DATE
[상품 별 오프라인 매출 구하기]
SELECT PRODUCT_CODE, SUM(SALES_AMOUNT)*PRICE AS SALES FROM PRODUCT JOIN OFFLINE_SALE ON PRODUCT.PRODUCT_ID=OFFLINE_SALE.PRODUCT_ID GROUP BY PRODUCT_CODE ORDER BY SALES DESC, PRODUCT_CODE

< LV 4 >
[주문량이 많은 아이스크림들 조회하기]
SELECT FLAVOR FROM (SELECT FLAVOR, TOTAL_ORDER FROM JULY 
UNION ALL 
SELECT FLAVOR, TOTAL_ORDER FROM FIRST_HALF)TB GROUP BY FLAVOR ORDER BY SUM(TOTAL_ORDER) DESC limit 3
[특정 기간동안 대여 가능한 자동차들의 대여비용 구하기]
SELECT TB.CAR_ID,TB.CAR_TYPE,ROUND(DAILY_FEE*(100-IFNULL(DISCOUNT_RATE,0))/100*30,0) AS FEE FROM (SELECT CAR_ID,CAR_TYPE,DAILY_FEE FROM CAR_RENTAL_COMPANY_CAR B WHERE CAR_ID NOT IN(SELECT DISTINCT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY A WHERE START_DATE<='2022-11-30' AND END_DATE>='2022-11-01') AND CAR_TYPE IN('세단','SUV'))TB LEFT OUTER JOIN (SELECT CAR_TYPE,DURATION_TYPE,DISCOUNT_RATE FROM CAR_RENTAL_COMPANY_DISCOUNT_PLAN C WHERE DURATION_TYPE='30일 이상')TB2 ON TB.CAR_TYPE=TB2.CAR_TYPE WHERE ROUND(DAILY_FEE*(100-IFNULL(DISCOUNT_RATE,0))/100*30,0)>=500000 AND ROUND(DAILY_FEE*(100-IFNULL(DISCOUNT_RATE,0))/100*30,0)<2000000 ORDER BY FEE DESC, TB.CAR_TYPE, TB.CAR_ID DESC
오답 - not을 안붙이고 or로 하려고 하면 크기만 하면 빠져버리기 때문에 포함범위가 더 켜져버린다. 그렇기 때문에 not and문이 맞다. 범위를 제대로 생각하지 못했다. 왜 제대로 생각하지 못했는가? not만 붙이면 반대가 된다고 생각했다.
[5월 식품들의 총매출 조회하기]
SELECT TB.PRODUCT_ID, B.PRODUCT_NAME,TB.AMOUNT*B.PRICE AS TOTAL_SALES FROM (SELECT PRODUCT_ID,SUM(AMOUNT) AS AMOUNT FROM FOOD_ORDER A WHERE PRODUCE_DATE>='2022-05-01' AND PRODUCE_DATE<='2022-05-31' GROUP BY PRODUCT_ID)TB LEFT OUTER JOIN FOOD_PRODUCT B ON TB.PRODUCT_ID=B.PRODUCT_ID ORDER BY TOTAL_SALES DESC, PRODUCT_ID
[그룹별 조건에 맞는 식당 목록 출력하기]
SELECT MEMBER_PROFILE.MEMBER_NAME, REVIEW_TEXT, DATE_FORMAT(REVIEW_DATE,'%Y-%m-%d') AS REVIEW_DATE FROM (SELECT * FROM REST_REVIEW WHERE MEMBER_ID IN(SELECT MEMBER_ID FROM REST_REVIEW GROUP BY MEMBER_ID HAVING COUNT(*)=(SELECT MAX(CNT) AS MAX_CNT FROM (SELECT COUNT(*) AS CNT FROM REST_REVIEW GROUP BY MEMBER_ID)TB)))TB2 LEFT OUTER JOIN MEMBER_PROFILE ON TB2.MEMBER_ID=MEMBER_PROFILE.MEMBER_ID ORDER BY REVIEW_DATE, REVIEW_TEXT
[보호소에서 중성화한 동물]
SELECT ANIMAL_INS.ANIMAL_ID,ANIMAL_INS.ANIMAL_TYPE,ANIMAL_INS.NAME FROM ANIMAL_INS JOIN ANIMAL_OUTS ON ANIMAL_INS.ANIMAL_ID=ANIMAL_OUTS.ANIMAL_ID WHERE LOCATE('Intact',SEX_UPON_INTAKE)!=0 AND LOCATE('Intact',SEX_UPON_OUTCOME)=0 ORDER BY ANIMAL_INS.ANIMAL_ID

< LV 5 >
[상품을 구매한 회원 비율 구하기]
SELECT YEAR,MONTH,COUNT(*) AS PUCHASED_USERS, ROUND(COUNT(*)/(SELECT COUNT(*) AS TOTAL_NUMBER FROM USER_INFO WHERE YEAR(JOINED)='2021'),1) AS PUCHASED_RATIO FROM (SELECT YEAR(ONLINE_SALE.SALES_DATE) AS YEAR,MONTH(ONLINE_SALE.SALES_DATE) AS MONTH,ONLINE_SALE.USER_ID AS USER_ID FROM ONLINE_SALE JOIN (SELECT USER_ID FROM USER_INFO WHERE YEAR(JOINED)='2021')USER_JOINED_2021_TB ON ONLINE_SALE.USER_ID=USER_JOINED_2021_TB.USER_ID GROUP BY YEAR(ONLINE_SALE.SALES_DATE),MONTH(ONLINE_SALE.SALES_DATE),ONLINE_SALE.USER_ID)TB GROUP BY YEAR, MONTH ORDER BY YEAR,MONTH