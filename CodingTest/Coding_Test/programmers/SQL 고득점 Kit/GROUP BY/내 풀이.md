< LV 2 >
[진료과별 총 예약 횟수 출력하기]
SELECT MCDP_CD AS '진료과코드', COUNT(*) AS '5월예약건수' FROM APPOINTMENT WHERE YEAR(APNT_YMD)=2022 AND MONTH(APNT_YMD)=5 GROUP BY MCDP_CD ORDER BY COUNT(*), MCDP_CD
[자동차 종류 별 특정 옵션이 포함된 자동차 수 구하기]
SELECT CAR_TYPE, COUNT(*) AS CARS FROM CAR_RENTAL_COMPANY_CAR WHERE OPTIONS =ANY (SELECT OPTIONS FROM CAR_RENTAL_COMPANY_CAR WHERE LOCATE('시트',OPTIONS)) GROUP BY CAR_TYPE ORDER BY CAR_TYPE
[성분으로 구분한 아이스크림 총 주문량]
SELECT INGREDIENT_TYPE,SUM(TOTAL_ORDER) AS TOTAL_ORDER FROM FIRST_HALF JOIN ICECREAM_INFO ON FIRST_HALF.FLAVOR=ICECREAM_INFO.FLAVOR GROUP BY INGREDIENT_TYPE ORDER BY SUM(TOTAL_ORDER)
[고양이와 개는 몇 마리 있을까]
SELECT ANIMAL_TYPE, COUNT(*) AS count FROM ANIMAL_INS GROUP BY ANIMAL_TYPE ORDER BY ANIMAL_TYPE
[동명 동물 수 찾기]
SELECT NAME, COUNT(*) AS COUNT FROM ANIMAL_INS WHERE NOT ISNULL(NAME) GROUP BY NAME HAVING COUNT(*)>=2 ORDER BY NAME
[입양 시각 구하기(1)]
SELECT HOUR(DATETIME) AS HOUR, COUNT(*) AS COUNT FROM ANIMAL_OUTS WHERE HOUR(DATETIME) BETWEEN 9 AND 19 GROUP BY HOUR(DATETIME) ORDER BY HOUR(DATETIME)
[가격대 별 상품 개수 구하기]
SELECT FLOOR(PRICE/10000)*10000 AS PRICE_GROUP, COUNT(*) AS PRODUCTS FROM PRODUCT GROUP BY FLOOR(PRICE/10000)*10000 ORDER BY FLOOR(PRICE/10000)*10000

< LV 3 >
[즐겨찾기가 가장 많은 식당 정보 출력하기]
SELECT FOOD_TYPE, REST_ID, REST_NAME, FAVORITES FROM REST_INFO WHERE (FOOD_TYPE, FAVORITES) IN(SELECT FOOD_TYPE,MAX(FAVORITES) FROM REST_INFO GROUP BY FOOD_TYPE) ORDER BY FOOD_TYPE DESC
[조건에 맞는 사용자와 총 거래금액 조회하기]
SELECT USER_ID, NICKNAME, SUM(PRICE) AS TOTAL_SALES FROM USED_GOODS_BOARD JOIN USED_GOODS_USER ON USED_GOODS_BOARD.WRITER_ID=USED_GOODS_USER.USER_ID AND STATUS='DONE' GROUP BY USED_GOODS_USER.USER_ID HAVING SUM(PRICE)>=700000 ORDER BY TOTAL_SALES
[카테고리 별 도서 판매량 집계하기]
SELECT CATEGORY,SUM(BOOK_SALES) AS TOTAL_SALES FROM (SELECT CATEGORY, SUM(SALES) AS BOOK_SALES FROM BOOK JOIN BOOK_SALES ON BOOK.BOOK_ID=BOOK_SALES.BOOK_ID WHERE DATE_FORMAT(SALES_DATE,"%Y-%m")='2022-01' GROUP BY BOOK.BOOK_ID)CATEGORY_BOOK_SALES GROUP BY CATEGORY ORDER BY CATEGORY
[자동차 대여 기록에서 대여중 / 대여 가능 여부 구분하기]
SELECT CAR_ID, IF(MAX(TF)=1,'대여중','대여 가능') AS AVAILABILITY FROM (SELECT CAR_ID, IF(START_DATE<='2022-10-16' AND END_DATE>='2022-10-16',1,0) AS TF FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY)TB GROUP BY CAR_ID ORDER BY CAR_ID DESC
[대여 횟수가 많은 자동차들의 월별 대여 횟수 구하기]
SELECT MONTH(START_DATE) AS MONTH, CAR_ID, COUNT(*) AS RECORDS FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE START_DATE BETWEEN '2022-08-01' AND '2022-10-31' AND CAR_ID IN(SELECT CAR_ID FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY WHERE START_DATE BETWEEN '2022-08-01' AND '2022-10-31' GROUP BY CAR_ID HAVING COUNT(*)>=5) GROUP BY MONTH(START_DATE), CAR_ID HAVING COUNT(*)!=0 ORDER BY MONTH(START_DATE), CAR_ID DESC
[없어진 기록 찾기]
SELECT ANIMAL_ID,NAME FROM ANIMAL_OUTS WHERE ANIMAL_ID NOT IN (SELECT ANIMAL_ID FROM ANIMAL_INS) ORDER BY ANIMAL_ID
SELECT ANIMAL_OUTS.ANIMAL_ID,ANIMAL_OUTS.NAME FROM ANIMAL_OUTS LEFT OUTER JOIN ANIMAL_INS ON ANIMAL_OUTS.ANIMAL_ID=ANIMAL_INS.ANIMAL_ID WHERE ANIMAL_INS.ANIMAL_ID is NULL ORDER BY ANIMAL_OUTS.ANIMAL_ID
[있었는데요 없었습니다]
SELECT ANIMAL_INS.ANIMAL_ID,ANIMAL_INS.NAME FROM ANIMAL_OUTS JOIN ANIMAL_INS ON ANIMAL_INS.ANIMAL_ID=ANIMAL_OUTS.ANIMAL_ID WHERE ANIMAL_INS.DATETIME>ANIMAL_OUTS.DATETIME ORDER BY ANIMAL_INS.DATETIME
[오랜 기간 보호한 동물]
SELECT ANIMAL_INS.NAME, ANIMAL_INS.DATETIME FROM ANIMAL_INS LEFT OUTER JOIN ANIMAL_OUTS ON ANIMAL_INS.ANIMAL_ID=ANIMAL_OUTS.ANIMAL_ID WHERE ANIMAL_OUTS.ANIMAL_ID is NULL ORDER BY ANIMAL_INS.DATETIME limit 3

< LV 4 >
[저자 별 카테고리 별 매출액 집계하기]
SELECT A.AUTHOR_ID, B.AUTHOR_NAME,A.CATEGORY,SUM(C.SALES*A.PRICE) AS TOTAL_SALES
FROM (BOOK A JOIN AUTHOR B ON A.AUTHOR_ID=B.AUTHOR_ID) JOIN BOOK_SALES C ON A.BOOK_ID=C.BOOK_ID
WHERE SALES_DATE LIKE '2022-01-%' 
GROUP BY A.AUTHOR_ID,A.CATEGORY
ORDER BY A.AUTHOR_ID, A.CATEGORY DESC
[식품분류별 가장 비싼 식품의 정보 조회하기]
SELECT CATEGORY,  PRICE AS MAX_PRICE, PRODUCT_NAME FROM FOOD_PRODUCT WHERE (CATEGORY,PRICE) IN (SELECT CATEGORY,MAX(PRICE) AS MAX_PRICE FROM FOOD_PRODUCT GROUP BY CATEGORY) AND CATEGORY IN ('과자','국','김치','식용유') ORDER BY MAX_PRICE DESC
[년, 월, 성별 별 상품 구매 회원 수 구하기]
SELECT YEAR, MONTH, GENDER, COUNT(*) FROM (SELECT DISTINCT USER_ID,YEAR(SALES_DATE) AS YEAR, MONTH(SALES_DATE) AS MONTH FROM ONLINE_SALE)A JOIN USER_INFO ON A.USER_ID=USER_INFO.USER_ID GROUP BY YEAR, MONTH, GENDER HAVING not ISNULL(GENDER) ORDER BY YEAR, MONTH, GENDER
[입양 시각 구하기(2)]
SET @HOUR = -1;
SELECT (@HOUR := @HOUR +1) AS HOUR,
    (SELECT COUNT(HOUR(DATETIME)) 
    FROM ANIMAL_OUTS 
    WHERE HOUR(DATETIME)=@HOUR) AS COUNT 
    FROM ANIMAL_OUTS
WHERE @HOUR < 23;
- 오답 : SET을 사용한 변수의 할당 방법을 통해 범위를 표시할 수 있다는 것을 배움, 그리고 반복문처럼 1씩 증가하여 위에 처럼 사용할 수 있다는 사실을 배움